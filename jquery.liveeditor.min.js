(function(g,k,s,i){var p="liveeditor-options";var f="liveeditor-old";var t="liveeditor-enabled";var a="liveeditor-original-value";var B="liveeditor-original-html";var y={fillControls:false,changedCss:"liveeditor-changed",editingCss:null,editorCss:null,combobox:{css:"combo"},checkbox:{css:"checkbox",checked:{value:"true",html:"X"},unchecked:{value:"false",html:""}},onGetValue:null,onSetValue:null,onChanged:null,onEditorCreating:null,onEditorOptions:function(C){return'<option value=""></option>'},onEditorOpened:null,onEditorFocused:null,onEditorClosed:null};var w=5;g.liveeditor={isEnabled:function(C){return A(C)},enable:function(C){return n(C)},disable:function(C){return e(C)},closeEditor:function(C){C.each(function(){m(this)});return C},get:function(C){var D=[];C.each(function(){var E=g(this);var F=E.children(0);if(!F.length||F.data(a)==null){D.push(b(E))}else{D.push(v(F))}});return D.length===1?D[0]:D},serialize:function(D,E){var C=[];D.filter(function(){var F=g(this);return(E||F.is("[name]"))&&F.data(p)}).each(function(){var G=g(this);var F=G.attr("name")||E.eq(G.index()).attr("name");C.push(encodeURIComponent(F)+"="+encodeURIComponent(b(G)))});return C.join("&")},serializeRow:function(D,G,F){var E=g(D).get(0);var C=[];g("*",D).filter(function(){return g(this).data(p)}).each(function(){var L=g(this);var K=b(L);var I=[];while(L.get(0)!=E){I.push(L.index());L=L.parent();if(L.index()===-1){break}}I=I.reverse();L=G;for(var J in I){L=L.children().eq(I[J])}var H=L.attr("name");if(H!==i){if(F!==i){H=H.replace("[]","["+F+"]")}C.push(H+"="+encodeURIComponent(K))}else{}});return C.join("&")},set:function(C,E,D){C.each(function(){var G=g(this);var F=b(G);if(G.data(f)==null){G.data(f,F)}if(r(G,E,D)){var H=G.data(f);if(E!==H){h(G)}}});return C},reset:function(C){C.each(function(){var D=g(this);var F=D.data(f);if(F!=null){var G=b(D);if(G!==F){D.data(f,G);var E=D.data(p);if(E.changedCss){D.removeClass(E.changedCss)}}}else{}});return C}};function q(){j(g(this))}function d(){o(this)}function u(){var E=g(this).unbind("focus",u).select();var C=E.parent().unbind("mouseleave",d);var D=C.data(p);if(C[0]===D._focusedContainer){return true}if(D._focusedContainer){if(!m(D._focusedContainer)){return false}}D._focusedContainer=C[0];E.keydown(l);if(g.isFunction(D.onEditorFocused)){D.onEditorFocused.call(C,E)}return true}function l(I){var H=I.keyCode||I.which;if(H==13){I.preventDefault();var D=g(this).parent();m(D)}else{if(H==27){I.preventDefault();var D=g(this).parent();o(D)}else{if(H==9){I.preventDefault();var D=g(this).parent();var E=D.data(p);m(D);var F=I.shiftKey?g(E._selector.get().reverse()):E._selector;var C=null;var G=false;do{F.each(function(){if(G&&A(g(this))){C=g(this);return false}else{if(this===D[0]){if(G){G=false;return false}else{G=true}}}});if(!G){break}}while(C==null);if(C!==null){j(C).focus()}}}}}function A(C){return C.data(t)===true}function n(C){if(!A(C)){C.data(t,true).mouseenter(q)}return C}function e(C){if(A(C)){C.data(t,false).unbind("mouseenter",q)}return C}function b(C){var E;var D=C.data(p);if(g.isFunction(D.onGetValue)){E=D.onGetValue.call(C)}if(E===i){E=C.hasClass(D.combobox.css)||C.hasClass(D.checkbox.css)?(C.attr("value")||""):C.text()}return E}function r(C,H,D,G){if(G===i){G=false}var I;var F=C.data(p);if(g.isFunction(F.onSetValue)){var I=F.onSetValue.call(C,H,D,G);if(I===false){return false}}if(I===i){if(C.hasClass(F.combobox.css)){C.attr("value",H)}else{if(C.hasClass(F.checkbox.css)){C.attr("value",H);if(D===null){D=(H==F.checkbox.checked.value)?F.checkbox.checked.html:F.checkbox.unchecked.html}}}if(D==null){D=H}C.html(D)}C.unbind("mouseleave",d).removeClass(F.editingCss);if(C[0]===F._focusedContainer){F._focusedContainer=null}var E=C.data(f);if(H!=E){if(F.changedCss){C.addClass(F.changedCss)}}else{if(F.changedCss){C.removeClass(F.changedCss)}}return true}function h(C){var D=C.data(p);if(g.isFunction(D.onChanged)){D.onChanged.call(C)}}function j(C){var D=C.data(p);var F=C.children(0);if(F.data(a)!=null){return F}var E=b(C);if(C.data(f)==null){C.data(f,E)}var F=z(C,E);F.focus(u);F.data(B,C.html());C.html(F).mouseleave(d).addClass(D.editingCss);if(g.isFunction(D.onEditorOpened)){D.onEditorOpened.call(C,F)}return F}function z(C,G){var E;var D=C.data(p);var F=D.onEditorCreating;if(F){E=F(C,G)}if(!E){if(C.hasClass(D.combobox.css)){E=g("<select>").width(C.width()-w);var H=D.onEditorOptions.call(C);switch(g.type(H)){case"string":E.append(g(H));break;default:break}g('option[value="'+G+'"]',E).prop("selected",true)}else{if(C.hasClass(D.checkbox.css)){E=g('<input type="checkbox"/>').prop("checked",(G==D.checkbox.checked.value))}else{E=g('<input type="text"/>').width(C.width()-w).val(G)}}}E.data(a,G);if(D.editorCss){E.addClass(D.editorCss)}return E}function m(I){var D=g(I);var G=D.children(0);if(!G.length||G.data(a)==null){return true}var C=G.data(a);var H=v(G);var E=x(G);if(!r(D,H,E)){return false}var F=D.data(p);if(C!=H){h(D)}if(g.isFunction(F.onEditorClosed)){F.onEditorClosed.call(D)}return true}function o(H){var D=g(H);var G=D.children(0);if(!G.length||G.data(a)==null){return true}var C=G.data(a);var F=G.data(B);if(!r(D,C,F,true)){return false}var E=D.data(p);if(g.isFunction(E.onEditorClosed)){E.onEditorClosed.call(D)}return true}function v(E){var F;var C=E.parent();var D=C.data(p);if(g.isFunction(D.onEditorGetValue)){F=D.onEditorGetValue.call(E)}if(F===i){if(E.is(":checkbox")){F=(E.prop("checked")?D.checkbox.checked.value:D.checkbox.unchecked.value)}else{if(E.is("select")){F=g("option:selected",E).val()}else{F=E.val()}}}return F}function x(F){var E;var C=F.parent();var D=C.data(p);if(g.isFunction(D.onEditorGetValue)){E=D.onEditorGetHtml.call(F)}if(E===i){if(F.is("select")){E=g(":selected",F).text()}else{E=null}}return E}function c(C,D){var H=g(C);H.data(p,D);if(D.fillControls){if(H.hasClass(D.combobox.css)){var G=b(H);H.data(f,G);var I=D.onEditorOptions.call(C);switch(g.type(I)){case"string":var F=g("<select>").append(I).find('option[value="'+G+'"]');var E=F.html();r(H,G,E,true);break;default:break}}else{if(H.hasClass(D.checkbox.css)){var G=b(H);H.data(f,G);r(H,G,null,true)}}}}g.fn.liveeditor=function(C){var D=g.extend({},y,C);D._focusedContainer=null;D._selector=this;this.each(function(){c(this,D)});g.liveeditor.enable(this);return this}}(jQuery,window,document));