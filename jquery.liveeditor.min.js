(function(e,t,n,r){function c(){w(e(this))}function h(){x(this)}function p(){var t=e(this).unbind("focus",p).select();var n=t.parent().unbind("mouseleave",h);var r=n.data(i);if(n[0]===r._focusedContainer){return true}if(r._focusedContainer){if(!S(r._focusedContainer))return false}r._focusedContainer=n[0];t.keydown(d);if(e.isFunction(r.onEditorFocused)){r.onEditorFocused.call(n,t)}return true}function d(t){var n=t.keyCode||t.which;if(n==13){t.preventDefault();var r=e(this).parent();S(r)}else if(n==27){t.preventDefault();var r=e(this).parent();x(r)}else if(n==9){t.preventDefault();var r=e(this).parent();var s=r.data(i);S(r);var u=t.shiftKey?e(s._selector.get().reverse()):s._selector;var a=null;var f=false;do{u.each(function(){if(f&&e(this).data(o)===true){a=e(this);return false}else if(this===r[0]){if(f){f=false;return false}else{f=true}}});if(!f){break}}while(a==null);if(a!==null){w(a).focus()}}}function v(e){if(e.data(o)!==true){e.data(o,true).mouseenter(c)}return e}function m(e){if(e.data(o)===true){e.data(o,false).unbind("mouseenter",c)}return e}function g(t){var n;var s=t.data(i);if(e.isFunction(s.onGetValue)){n=s.onGetValue.call(t)}if(n===r){n=t.hasClass(s.combobox.css)||t.hasClass(s.checkbox.css)?t.attr("value"):t.text()}return n}function y(t,n,o,u){if(u===r)u=false;var a;var f=t.data(i);if(e.isFunction(f.onSetValue)){var a=f.onSetValue.call(t,n,o,u);if(a===false)return false}if(a===r){if(t.hasClass(f.combobox.css)){t.attr("value",n)}else if(t.hasClass(f.checkbox.css)){t.attr("value",n);if(o===null)o=n==f.checkbox.checked.value?f.checkbox.checked.html:f.checkbox.unchecked.html}if(o===null||o===r)o=n;t.html(o)}t.unbind("mouseleave",h).removeClass(f.editingCss);if(t[0]===f._focusedContainer){f._focusedContainer=null}var l=t.data(s);if(n!=l){if(f.changedCss)t.addClass(f.changedCss)}else{if(f.changedCss)t.removeClass(f.changedCss)}return true}function b(t){var n=t.data(i);if(e.isFunction(n.onChanged)){n.onChanged.call(t)}}function w(t){var n=t.data(i);var o=t.children(0);if(o.data(u)!==r){return o}var f=g(t);if(t.data(s)===r){t.data(s,f)}var o=E(t,f);o.focus(p);o.data(a,t.html());t.html(o).mouseleave(h).addClass(n.editingCss);if(e.isFunction(n.onEditorOpened)){n.onEditorOpened.call(t,o)}return o}function E(t,n){var r;var s=t.data(i);var o=s.onEditorCreating;if(o){r=o(t,n)}if(!r){if(t.hasClass(s.combobox.css)){r=e("<select>").width(t.width()-l);var a=s.onEditorOptions.call(t);switch(e.type(a)){case"string":r.append(e(a));break;default:break}e('option[value="'+n+'"]',r).prop("selected",true)}else if(t.hasClass(s.checkbox.css))r=e('<input type="checkbox"/>').prop("checked",n==s.checkbox.checked.value);else{r=e('<input type="text"/>').width(t.width()-l).val(n)}}r.data(u,n);if(s.editorCss){r.addClass(s.editorCss)}return r}function S(t){var n=e(t);var s=n.children(0);if(!s.length||s.data(u)===r){return true}var o=s.data(u);var a=T(s);var f=N(s);if(!y(n,a,f)){return false}var l=n.data(i);if(o!=a){b(n)}if(e.isFunction(l.onEditorClosed)){l.onEditorClosed.call(n)}return true}function x(t){var n=e(t);var s=n.children(0);if(!s.length||s.data(u)===r){return true}var o=s.data(u);var f=s.data(a);if(!y(n,o,f,true)){return false}var l=n.data(i);if(e.isFunction(l.onEditorClosed)){l.onEditorClosed.call(n)}return true}function T(t){var n;var s=t.parent();var o=s.data(i);if(e.isFunction(o.onEditorGetValue)){n=o.onEditorGetValue.call(t)}if(n===r){if(t.is(":checkbox"))n=t.prop("checked")?o.checkbox.checked.value:o.checkbox.unchecked.value;else if(t.is("select"))n=e("option:selected",t).val();else n=t.val()}return n}function N(t){var n;var s=t.parent();var o=s.data(i);if(e.isFunction(o.onEditorGetValue)){n=o.onEditorGetHtml.call(t)}if(n===r){if(t.is("select"))n=e(":selected",t).text();else n=null}return n}function C(t,n){e(t).data(i,n)}var i="liveeditor-options";var s="liveeditor-old";var o="liveeditor-enabled";var u="liveeditor-original-value";var a="liveeditor-original-html";var f={changedCss:"liveeditor-changed",editingCss:null,editorCss:null,combobox:{css:"combo"},checkbox:{css:"checkbox",checked:{value:"true",html:"X"},unchecked:{value:"false",html:""}},onGetValue:null,onSetValue:null,onChanged:null,onEditorCreating:null,onEditorOptions:function(e){return'<option value=""></option>'},onEditorOpened:null,onEditorFocused:null,onEditorClosed:null};var l=5;e.liveeditor={enable:function(e){return v(e)},disable:function(e){return m(e)},closeEditor:function(e){e.each(function(){S(this)});return e},get:function(t){var n=[];t.each(function(){var t=g(e(this));n.push(t)});return n.length===1?n[0]:n},serialize:function(t,n){var r=[];t.filter(function(){var t=e(this);return(n||t.is("[name]"))&&t.data(i)}).each(function(){var t=e(this);var i=t.attr("name")||n.eq(t.index()).attr("name");r.push(encodeURIComponent(i)+"="+encodeURIComponent(g(t)))});return r.join("&")},serializeRow:function(t,n){var s=e(t).get(0);var o=[];e("*",t).filter(function(){return e(this).data(i)}).each(function(){var t=e(this);var i=g(t);var u=[];while(t.get(0)!=s){u.push(t.index());t=t.parent();if(t.index()===-1)break}u=u.reverse();t=n;for(var a in u){t=t.children().eq(u[a])}var f=t.attr("name");if(f!==r){o.push(encodeURIComponent(f)+"="+encodeURIComponent(i))}else{}});return o.join("&")},set:function(t,n,i){t.each(function(){var t=e(this);var o=g(t);if(t.data(s)===r){t.data(s,o)}if(y(t,n,i)){var u=t.data(s);if(n!==u){b(t)}}});return t},reset:function(t){t.each(function(){var t=e(this);var n=t.data(s);if(n!==r){var o=g(t);if(o!==n){t.data(s,o);var u=t.data(i);if(u.changedCss)t.removeClass(u.changedCss);b(t)}}else{}});return t}};e.fn.liveeditor=function(t){var n=e.extend({},f,t);n._focusedContainer=null;n._selector=this;this.each(function(){C(this,n)});e.liveeditor.enable(this);return this}})(jQuery,window,document)